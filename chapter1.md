# Почему Connection нужно закрывать

Достаточно частая проблема у разработчиков, использующих JDBC - это не закрытый connection в базу данных.

Давайте рассмотрим пример, в котором создается 1000 соединений с БД, внутри каждого соединения выполняется какая-та полезная работа \( в нашем случае создание и удаление таблицы\), но никакой обработки завершения работы с БД нет.

> Заодно вы сможете заметить, что открытие 1000 соединений с вашей любимой БД - удовольствие достаточно затратное по времени и памяти \(попробуйте замерить разницу до выполнения кода и после в качестве упражнения\).

Пример кода с github: TODO

Если вы просто запустите этот код и подождете, то по достижении лимита на количество соединений вы получите следующее сообщение:

![](/assets/ExceptionFromJDBCDriver.png)

Если по какой-то причине подобная исключительная ситуация не возникает, попробуйте увеличить количество итераций в цикле или же уменьшить верхний лимит на соединения с БД в настройка самой БД \(для MySQL эта настройка называется max\_connections и легко меняется через Workbench\)

![](/assets/MySQLSettingsMaxConnection.png)

Вся проблема в исчерпании ресурсов: мы сделали какие-то дела, но не обратились к БД с просьбой закрыть двери за гостями.

Так давайте же закроем за собой двери!

Достаточно добавить connection.close\(\) в конце блока кода.



